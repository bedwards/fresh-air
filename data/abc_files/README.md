# ABC Notation Corpus

This directory contains generated ABC notation files for transformer interpretability analysis.

## Generation Approach

The corpus is generated by `src/abc_generator.py` using algorithmic composition techniques tailored to each genre. The goal is to create diverse musical material that will reveal different transformer activation patterns.

## Genres

### Traditional (5 files)

Traditional pieces use diatonic scales, predictable phrase structures, and conventional cadences. The generator cycles through:

1. **Irish Jigs** (6/8 time)
   - Compound duple meter with two groups of three eighth notes per beat
   - Stepwise melodic motion with occasional thirds and fourths
   - Keys: G, D, A, Em, Am major
   - AABB structure (8-bar A section, 8-bar B section, each repeated)

2. **Slip Jigs** (9/8 time)
   - Compound triple meter with three groups of three eighth notes per bar
   - Diatonic scale patterns with smooth voice leading
   - Common in Irish dance music

3. **Reels** (4/4 time)
   - Continuous eighth note runs
   - Four-note groups with directional patterns
   - Scalar passages with small interval leaps

4. **Hymns** (4/4 time, 4 voices)
   - SATB chorale-style harmonization
   - Standard chord progressions (I-IV-V-I, I-vi-IV-V, etc.)
   - Whole note durations for sustained harmonies

### Avant-garde (5 files)

Avant-garde pieces use unusual time signatures and chromatic harmony:

- **Time signatures**: 5/8, 7/8, 11/8, 5/4, 7/4
- **Modes**: Mixolydian, Dorian, Lydian, Locrian, Phrygian
- **Melodic intervals**: Wide leaps (tritones, 7ths, 9ths) alongside chromatic steps
- **Rhythm**: Irregular phrase lengths based on meter

### Experimental (5 files)

Dense 4-voice chromatic polyphony:

- **Texture**: Four independent voice lines
- **Pitch content**: Chromatic movement with occasional octave leaps
- **Register**: Extreme range changes within each voice
- **Duration**: Varied note lengths (sixteenth notes to half notes)
- **Rests**: Occasional silences create rhythmic complexity

### Noise (5 files)

Completely random sequences:

- **Pitch**: Random note selection from all 7 natural notes
- **Accidentals**: Random sharps, flats, double-sharps, double-flats
- **Octave**: Random register across full range
- **Duration**: Random note lengths including triplet divisions
- **Structure**: No coherent phrase structure or tonal center

### Terrible (5 files)

Intentionally bad voice leading for contrast:

1. **Parallel Fifths**: Two voices moving in perfect fifths throughout
2. **Parallel Octaves**: Voices doubled at the octave in parallel motion
3. **Voice Crossing**: Voices cross each other repeatedly
4. **Awkward Range**: Notes in extreme, unplayable registers
5. **Unresolved Dissonance**: Major 7ths and minor 2nds left unresolved

### Silence (5 files)

Sparse, meditative pieces:

- **Note density**: ~15% of measures contain notes
- **Rhythm**: Isolated notes surrounded by rests
- **Duration**: Full-measure rests predominate
- **Content**: Ensures at least 3 notes per piece for minimal content

## File Format

Each ABC file has a companion JSON metadata file containing:

```json
{
  "filename": "traditional_001.abc",
  "genre": "traditional",
  "subgenre": "irish_jig",
  "description": "Irish jig in G with typical compound duple meter patterns",
  "voices": 1,
  "measures": 16,
  "time_signature": "6/8",
  "key": "G",
  "tempo": 120,
  "generation_params": {
    "seed": 43,
    "algorithm": "irish_jig",
    "structure": "AABB"
  }
}
```

## Usage

Generate the full corpus:

```bash
python src/abc_generator.py --all --count 5 --seed 42
```

Generate specific genre:

```bash
python src/abc_generator.py --genre traditional --count 10 --seed 42
```

## ABC Notation Reference

Basic syntax used in these files:

- `X:` - Tune reference number
- `T:` - Title
- `C:` - Composer
- `M:` - Meter (e.g., 4/4, 6/8, 7/8)
- `L:` - Default note length
- `Q:` - Tempo
- `K:` - Key signature (including modes like Gmix, Ddor)
- `V:` - Voice definition for multi-voice pieces

Note names:
- `C D E F G A B` - Natural notes (uppercase = middle octave)
- `c d e f g a b` - Octave higher (lowercase)
- `C, D,` - Octave lower (comma suffix)
- `c' d'` - Two octaves higher (apostrophe suffix)

Accidentals:
- `^C` - C sharp
- `_C` - C flat
- `=C` - C natural (explicit)
- `^^C` - C double-sharp
- `__C` - C double-flat

Durations:
- `C` - Default length (as set by L:)
- `C2` - Double length
- `C/2` - Half length
- `z` - Rest

## Research Purpose

This corpus is designed for transformer interpretability research. The diverse genres should produce distinct activation patterns:

- **Traditional**: Predictable patterns, diatonic relationships
- **Avant-garde**: Extended techniques, unusual intervals
- **Experimental**: Dense polyphony, chromatic saturation
- **Noise**: No learnable patterns (control/baseline)
- **Terrible**: Explicit rule violations for feature detection
- **Silence**: Sparse activations, rest handling

By analyzing how models process these different musical styles, we can understand what musical features transformers learn to represent.
